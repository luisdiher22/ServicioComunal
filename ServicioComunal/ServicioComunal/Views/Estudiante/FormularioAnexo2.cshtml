@model ServicioComunal.Models.Anexo2FormularioDto
@{
    ViewData["Title"] = "Formulario Anexo #2";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var entrega = ViewBag.Entrega as ServicioComunal.Models.Entrega;
    var estudiantes = ViewBag.Estudiantes as List<ServicioComunal.Models.Estudiante>;
}

<div class="container mt-4">
    <div class="row">
        <div class="col-md-10 mx-auto">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">
                        <i class="fas fa-file-alt"></i>
                        Anexo #2: @entrega?.Nombre
                    </h4>
                    <p class="mb-0">Completar la información solicitada para generar el PDF</p>
                </div>
                
                <div class="card-body">
                    @if (TempData["Error"] != null)
                    {
                        <div class="alert alert-danger alert-dismissible fade show" role="alert">
                            <i class="fas fa-exclamation-triangle"></i>
                            @TempData["Error"]
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                    }

                    <form asp-controller="Estudiante" asp-action="GuardarAnexo2" method="post" id="anexo2Form">
                        <input type="hidden" name="entregaId" value="@entrega?.Identificacion" />
                        
                        <!-- Información del Proyecto -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h5 class="text-primary border-bottom pb-2">
                                    <i class="fas fa-project-diagram"></i>
                                    Información del Proyecto
                                </h5>
                            </div>
                            <div class="col-12">
                                <div class="form-group mb-3">
                                    <label asp-for="NombreProyecto" class="form-label fw-bold">
                                        Nombre del Proyecto <span class="text-danger">*</span>
                                    </label>
                                    <input asp-for="NombreProyecto" class="form-control" required 
                                           placeholder="Ingrese el nombre del proyecto">
                                    <span asp-validation-for="NombreProyecto" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="form-group mb-3">
                                    <label asp-for="Tutor" class="form-label fw-bold">
                                        Tutor <span class="text-danger">*</span>
                                    </label>
                                    <input asp-for="Tutor" class="form-control" required 
                                           placeholder="Ingrese el nombre del tutor">
                                    <span asp-validation-for="Tutor" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Información de Estudiantes -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h5 class="text-primary border-bottom pb-2">
                                    <i class="fas fa-users"></i>
                                    Estudiantes Participantes
                                </h5>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label asp-for="Nombre1" class="form-label fw-bold">
                                        Estudiante 1 <span class="text-danger">*</span>
                                    </label>
                                    <input asp-for="Nombre1" class="form-control" required 
                                           placeholder="Nombre del estudiante 1">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label asp-for="Seccion1" class="form-label fw-bold">
                                        Sección 1 <span class="text-danger">*</span>
                                    </label>
                                    <input asp-for="Seccion1" class="form-control" required 
                                           placeholder="Sección del estudiante 1">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label asp-for="Nombre2" class="form-label fw-bold">
                                        Estudiante 2
                                    </label>
                                    <input asp-for="Nombre2" class="form-control" 
                                           placeholder="Nombre del estudiante 2">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label asp-for="Seccion2" class="form-label fw-bold">
                                        Sección 2
                                    </label>
                                    <input asp-for="Seccion2" class="form-control" 
                                           placeholder="Sección del estudiante 2">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label asp-for="Nombre3" class="form-label fw-bold">
                                        Estudiante 3
                                    </label>
                                    <input asp-for="Nombre3" class="form-control" 
                                           placeholder="Nombre del estudiante 3">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label asp-for="Seccion3" class="form-label fw-bold">
                                        Sección 3
                                    </label>
                                    <input asp-for="Seccion3" class="form-control" 
                                           placeholder="Sección del estudiante 3">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label asp-for="Nombre4" class="form-label fw-bold">
                                        Estudiante 4
                                    </label>
                                    <input asp-for="Nombre4" class="form-control" 
                                           placeholder="Nombre del estudiante 4">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label asp-for="Seccion4" class="form-label fw-bold">
                                        Sección 4
                                    </label>
                                    <input asp-for="Seccion4" class="form-control" 
                                           placeholder="Sección del estudiante 4">
                                </div>
                            </div>
                        </div>

                        <!-- Áreas de Interés -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h5 class="text-primary border-bottom pb-2">
                                    <i class="fas fa-heart"></i>
                                    Áreas de Interés
                                </h5>
                                <p class="text-muted mb-3">Seleccione las áreas relacionadas con su proyecto:</p>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check mb-2">
                                    <input asp-for="MedioAmbiente" class="form-check-input" type="checkbox">
                                    <label asp-for="MedioAmbiente" class="form-check-label">
                                        Medio Ambiente
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input asp-for="JovenesApoyandoJovenes" class="form-check-input" type="checkbox">
                                    <label asp-for="JovenesApoyandoJovenes" class="form-check-label">
                                        Jóvenes Apoyando Jóvenes
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input asp-for="InformacionEstudiantil" class="form-check-input" type="checkbox">
                                    <label asp-for="InformacionEstudiantil" class="form-check-label">
                                        Información Estudiantil
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check mb-2">
                                    <input asp-for="Arte" class="form-check-input" type="checkbox">
                                    <label asp-for="Arte" class="form-check-label">
                                        Arte
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input asp-for="EstilosVidaSaludables" class="form-check-input" type="checkbox">
                                    <label asp-for="EstilosVidaSaludables" class="form-check-label">
                                        Estilos de Vida Saludables
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input asp-for="Otros" class="form-check-input" type="checkbox" onchange="toggleOtrosField()">
                                    <label asp-for="Otros" class="form-check-label">
                                        Otros
                                    </label>
                                </div>
                                <div class="form-group mt-2" id="otrosField" style="display: none;">
                                    <input asp-for="OtrosEspecifique" class="form-control" 
                                           placeholder="Especifique otros...">
                                </div>
                            </div>
                        </div>

                        <!-- Descripción del Proyecto -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h5 class="text-primary border-bottom pb-2">
                                    <i class="fas fa-file-text"></i>
                                    Descripción del Proyecto
                                </h5>
                            </div>
                            <div class="col-12">
                                <div class="form-group mb-3">
                                    <label asp-for="BreveDescripcion" class="form-label fw-bold">
                                        Breve Descripción <span class="text-danger">*</span>
                                    </label>
                                    <textarea asp-for="BreveDescripcion" class="form-control" rows="6" required
                                              placeholder="Describa brevemente el proyecto, sus objetivos y beneficiarios..."></textarea>
                                    <span asp-validation-for="BreveDescripcion" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Botones de Acción -->
                        <div class="row">
                            <div class="col-12">
                                <div class="d-flex justify-content-between align-items-center border-top pt-3">
                                    <a href="@Url.Action("DetalleEntrega", "Estudiante", new { id = entrega?.Identificacion })" 
                                       class="btn btn-outline-secondary">
                                        <i class="fas fa-arrow-left"></i>
                                        Volver
                                    </a>
                                    
                                    <div>
                                        <button type="button" class="btn btn-outline-primary me-2" onclick="guardarBorrador()">
                                            <i class="fas fa-save"></i>
                                            Guardar Borrador
                                        </button>
                                        
                                        <button type="submit" class="btn btn-success">
                                            <i class="fas fa-file-pdf"></i>
                                            Generar PDF Final
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function toggleOtrosField() {
    const checkbox = document.querySelector('input[name="Otros"]');
    const field = document.getElementById('otrosField');
    
    if (checkbox && checkbox.checked) {
        field.style.display = 'block';
    } else {
        field.style.display = 'none';
        const otrosInput = document.querySelector('input[name="OtrosEspecifique"]');
        if (otrosInput) {
            otrosInput.value = '';
        }
    }
}

function guardarBorrador() {
    // Implementar funcionalidad de guardar borrador
    alert('Funcionalidad de guardar borrador pendiente de implementar');
}
</script>
